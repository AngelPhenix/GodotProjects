[gd_scene load_steps=18 format=3 uid="uid://dhuxodl27ot5d"]

[ext_resource type="PackedScene" uid="uid://djgakgpiefo2w" path="res://scenes/Stars.tscn" id="1"]
[ext_resource type="PackedScene" uid="uid://naq1g0c6maxa" path="res://scenes/Ship.tscn" id="2"]
[ext_resource type="PackedScene" uid="uid://lsb0dolqx4ib" path="res://scenes/Spawner_enemy.tscn" id="3"]
[ext_resource type="Texture2D" uid="uid://rkgxdp8krt1e" path="res://sprites/health.png" id="4"]
[ext_resource type="Texture2D" uid="uid://dgs8gskqcn7qb" path="res://sprites/SelfMadeArt/score.png" id="5"]
[ext_resource type="FontFile" uid="uid://cstv4jfpevm1" path="res://fonts/m5x7.ttf" id="6"]
[ext_resource type="Texture2D" uid="uid://jy3bowg7l41g" path="res://sprites/SelfMadeArt/button_normal.png" id="7"]
[ext_resource type="Texture2D" uid="uid://f7v8uhm2hw4a" path="res://sprites/SelfMadeArt/button_pressed.png" id="8"]
[ext_resource type="Texture2D" uid="uid://cspgtd7h2d3x3" path="res://sprites/SelfMadeArt/button_hover.png" id="9"]

[sub_resource type="GDScript" id="1"]
resource_name = "spr_health"
script/source = "extends Sprite2D

func _on_Ship_health_changed(health):
	if frame > 0:
		set_frame(health)
"

[sub_resource type="GDScript" id="2"]
resource_name = "tex_score"
script/source = "extends TextureRect

var score = 0: set = set_score

func _ready():
	$label.text = str(score)

func set_score(new_value):
	score = new_value
	$label.set_text(str(score))
	if score > score_max.bestscore:
		score_max.bestscore = score
"

[sub_resource type="FontFile" id="3"]
fallbacks = Array[Font]([ExtResource("6"), ExtResource("6")])
subpixel_positioning = 0
msdf_pixel_range = 14
msdf_size = 128
cache/0/16/0/ascent = 0.0
cache/0/16/0/descent = 0.0
cache/0/16/0/underline_position = 0.0
cache/0/16/0/underline_thickness = 0.0
cache/0/16/0/scale = 1.0

[sub_resource type="GDScript" id="4"]
resource_name = "btn_restart"
script/source = "extends TextureButton

func _on_Ship_tree_exited():
	show()

func _on_btn_restart_pressed():
	get_parent().get_node(\"tex_score\").score = 0
	get_tree().change_scene_to_file(\"res://stages/Stage_Game.tscn\")
"

[sub_resource type="CompressedTexture2D" id="5"]

[sub_resource type="CompressedTexture2D" id="6"]

[sub_resource type="CompressedTexture2D" id="7"]

[sub_resource type="GDScript" id="8"]
resource_name = "btn_menu"
script/source = "extends TextureButton

func _on_Ship_tree_exited():
	show()

func _on_btn_menu_pressed():
	get_tree().change_scene_to_file(\"res://stages/Stage_Menu.tscn\")
"

[node name="World_01" type="Node" groups=["world"]]

[node name="Stars" parent="." instance=ExtResource("1")]

[node name="Ship" parent="." instance=ExtResource("2")]
position = Vector2(88.0786, 280)

[node name="Spawner_enemy" parent="." instance=ExtResource("3")]

[node name="Hud" type="CanvasLayer" parent="."]

[node name="spr_health" type="Sprite2D" parent="Hud"]
position = Vector2(10, 10)
texture = ExtResource("4")
centered = false
hframes = 9
frame = 4
script = SubResource("1")

[node name="tex_score" type="TextureRect" parent="Hud" groups=["score"]]
offset_left = 123.0
offset_top = 10.0
offset_right = 170.0
offset_bottom = 27.0
texture = ExtResource("5")
script = SubResource("2")

[node name="label" type="Label" parent="Hud/tex_score"]
layout_mode = 0
offset_left = 3.0
offset_top = 1.0
offset_right = 43.0
offset_bottom = 14.0
theme_override_fonts/font = SubResource("3")
text = "0"
horizontal_alignment = 2

[node name="btn_restart" type="TextureButton" parent="Hud"]
visible = false
offset_left = 67.0
offset_top = 144.0
offset_right = 114.0
offset_bottom = 160.0
texture_normal = ExtResource("7")
texture_pressed = ExtResource("8")
texture_hover = ExtResource("9")
script = SubResource("4")

[node name="label" type="Label" parent="Hud/btn_restart"]
layout_mode = 0
offset_right = 48.0
offset_bottom = 16.0
theme_override_fonts/font = SubResource("3")
text = "RESTART"
horizontal_alignment = 1

[node name="btn_menu" type="TextureButton" parent="Hud"]
visible = false
offset_left = 66.0
offset_top = 162.0
offset_right = 113.0
offset_bottom = 178.0
texture_normal = SubResource("5")
texture_pressed = SubResource("6")
texture_hover = SubResource("7")
script = SubResource("8")

[node name="label" type="Label" parent="Hud/btn_menu"]
layout_mode = 0
offset_right = 48.0
offset_bottom = 16.0
theme_override_fonts/font = SubResource("3")
text = "MENU"
horizontal_alignment = 1

[connection signal="health_changed" from="Ship" to="Hud/spr_health" method="_on_Ship_health_changed"]
[connection signal="tree_exited" from="Ship" to="Hud/btn_restart" method="_on_Ship_tree_exited"]
[connection signal="tree_exited" from="Ship" to="Hud/btn_menu" method="_on_Ship_tree_exited"]
[connection signal="pressed" from="Hud/btn_restart" to="Hud/btn_restart" method="_on_btn_restart_pressed"]
[connection signal="pressed" from="Hud/btn_menu" to="Hud/btn_menu" method="_on_btn_menu_pressed"]
